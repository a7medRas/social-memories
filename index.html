<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Social Memories</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0; padding: 0; background: #f0f2f5;
  }
  nav {
    display: flex;
    justify-content: space-around;
    background: #007bff;
    color: white;
    padding: 12px 0;
    position: fixed;
    width: 100%;
    bottom: 0;
    z-index: 10;
  }
  nav button {
    background: none;
    border: none;
    color: white;
    font-size: 20px;
    cursor: pointer;
  }
  nav button:hover {
    text-decoration: underline;
  }
  #content > div {
    display: none;
    padding: 16px;
    margin-bottom: 60px; /* space for fixed nav */
  }
  #content > div.active {
    display: block;
  }
  .memory {
    background: white;
    padding: 10px;
    margin-bottom: 10px;
    border-radius: 6px;
  }
  .memory-buttons button {
    margin-left: 10px;
    cursor: pointer;
  }
  .comment {
    background: #eef1f6;
    margin: 6px 0 6px 20px;
    padding: 6px;
    border-radius: 4px;
  }
  .chat-window {
    height: 300px;
    border: 1px solid #ccc;
    background: white;
    overflow-y: auto;
    padding: 8px;
    border-radius: 6px;
    margin-bottom: 8px;
  }
  .chat-message {
    margin-bottom: 6px;
  }
  .chat-message.user {
    text-align: right;
    font-weight: bold;
  }
  input[type="text"], select, textarea {
    width: 100%;
    padding: 8px;
    margin: 6px 0 12px 0;
    box-sizing: border-box;
    font-size: 16px;
  }
  button.submit-btn {
    background: #007bff;
    color: white;
    border: none;
    padding: 10px;
    width: 100%;
    border-radius: 6px;
    cursor: pointer;
    font-size: 16px;
  }
  button.submit-btn:hover {
    background: #0056b3;
  }
  ul#searchResults {
    list-style: none;
    padding: 0;
  }
  ul#searchResults li {
    background: white;
    margin-bottom: 6px;
    padding: 8px;
    border-radius: 6px;
    cursor: pointer;
  }
  ul#searchResults li:hover {
    background: #cce5ff;
  }
</style>
</head>
<body>

<nav>
  <button id="btnLive">ğŸ”´ Ø¨Ø« Ù…Ø¨Ø§Ø´Ø±</button>
  <button id="btnChat">ğŸ’¬ Ø¯Ø±Ø¯Ø´Ø©</button>
  <button id="btnSearch">ğŸ” Ø¨Ø­Ø« Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</button>
  <button id="btnNewMemory">ğŸ“ Ù†Ø´Ø± Ø°ÙƒØ±Ù‰ Ø¬Ø¯ÙŠØ¯Ø©</button>
</nav>

<div id="content">
  <div id="memoriesSection" class="active">
    <h2>ğŸ“¸ Ø°ÙƒØ±ÙŠØ§Øª</h2>
    <div id="memoriesList">
      <!-- Ø§Ù„Ø°ÙƒØ±ÙŠØ§Øª ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
    </div>
  </div>

  <div id="chatSection">
    <h2>ğŸ’¬ Ø¯Ø±Ø¯Ø´Ø©</h2>
    <div class="chat-window" id="chatWindow"></div>
    <input type="text" id="chatInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©..." />
    <button id="sendChatBtn" class="submit-btn">Ø¥Ø±Ø³Ø§Ù„</button>
  </div>

  <div id="searchSection">
    <h2>ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h2>
    <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…..." autocomplete="off"/>
    <ul id="searchResults"></ul>
  </div>

  <div id="newMemorySection">
    <h2>ğŸ“ Ù†Ø´Ø± Ø°ÙƒØ±Ù‰ Ø¬Ø¯ÙŠØ¯Ø©</h2>
    <form id="memoryForm">
      <input type="text" id="memoryTitle" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø°ÙƒØ±Ù‰" required />
      <textarea id="memoryText" placeholder="Ø§ÙƒØªØ¨ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø°ÙƒØ±Ù‰..." rows="4" required></textarea>
      <label for="moodSelect">Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø²Ø§Ø¬ÙŠØ©:</label>
      <select id="moodSelect" required>
        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø­Ø§Ù„Ø©</option>
        <option value="Ø³Ø¹ÙŠØ¯Ø©">ğŸ˜Š Ø³Ø¹ÙŠØ¯Ø©</option>
        <option value="ÙØ±Ø­">ğŸ˜„ ÙØ±Ø­</option>
        <option value="Ù…Ø­Ø¨Ø©">â¤ï¸ Ù…Ø­Ø¨Ø©</option>
        <option value="Ø­Ø²Ù†">ğŸ˜¢ Ø­Ø²Ù†</option>
        <option value="ØºØ¶Ø¨">ğŸ˜  ØºØ¶Ø¨</option>
      </select>
      <br />
      <label for="memoryImage">ØµÙˆØ±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):</label><br />
      <input type="file" id="memoryImage" accept="image/*" capture="environment" />
      <br /><br />
      <button type="submit" class="submit-btn">Ù†Ø´Ø± Ø§Ù„Ø°ÙƒØ±Ù‰</button>
    </form>
  </div>
</div>

<script>
// Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙ‡Ù…ÙŠØ© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆØ§Ù„Ø°ÙƒØ±ÙŠØ§Øª
const users = [
  { uid: "u1", displayName: "Ø¹Ù„ÙŠ" },
  { uid: "u2", displayName: "Ø³Ø§Ø±Ø©" },
  { uid: "u3", displayName: "Ù…Ø­Ù…Ø¯" },
];

let memories = [
  {
    id: "m1",
    title: "Ø±Ø­Ù„Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø´Ø§Ø·Ø¦",
    text: "Ù‚Ø¶ÙŠØª ÙŠÙˆÙ… Ø¬Ù…ÙŠÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø­Ø± Ù…Ø¹ Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡.",
    mood: "Ø³Ø¹ÙŠØ¯Ø©",
    likes: 3,
    commentsCount: 2,
    comments: [
      { displayName: "Ø³Ø§Ø±Ø©", text: "Ù…Ø§ Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡! ØµÙˆØ± Ø±Ø§Ø¦Ø¹Ø© ğŸ˜Š", photoURL: null },
      { displayName: "Ø¹Ù„ÙŠ", text: "Ù…ØªÙ‰ Ù†ÙƒØ±Ø±Ù‡Ø§ØŸ", photoURL: null }
    ],
  },
  {
    id: "m2",
    title: "Ø­ÙÙ„Ø© Ø¹ÙŠØ¯ Ù…ÙŠÙ„Ø§Ø¯",
    text: "Ø§Ø­ØªÙÙ„Ù†Ø§ Ø¨Ø¹ÙŠØ¯ Ù…ÙŠÙ„Ø§Ø¯ Ø£Ø®ØªÙŠ Ù…Ø¹ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©.",
    mood: "ÙØ±Ø­",
    likes: 5,
    commentsCount: 1,
    comments: [
      { displayName: "Ù…Ø­Ù…Ø¯", text: "Ø¹ÙŠØ¯ Ù…ÙŠÙ„Ø§Ø¯ Ø³Ø¹ÙŠØ¯! ğŸ‰", photoURL: null },
    ],
  },
];

// Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø¹Ø±Ø¶ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
const btnLive = document.getElementById("btnLive");
const btnChat = document.getElementById("btnChat");
const btnSearch = document.getElementById("btnSearch");
const btnNewMemory = document.getElementById("btnNewMemory");

const memoriesSection = document.getElementById("memoriesSection");
const newMemorySection = document.getElementById("newMemorySection");
const chatSection = document.getElementById("chatSection");
const searchSection = document.getElementById("searchSection");

function hideAllSections() {
  memoriesSection.classList.remove("active");
  newMemorySection.classList.remove("active");
  chatSection.classList.remove("active");
  searchSection.classList.remove("active");
}

btnLive.addEventListener("click", () => {
  alert("âš ï¸ Ø®Ø§ØµÙŠØ© Ø§Ù„Ø¨Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù‚ÙŠØ¯ Ø§Ù„ØµÙŠØ§Ù†Ø© Ø­Ø§Ù„ÙŠØ§Ù‹");
});

btnChat.addEventListener("click", () => {
  hideAllSections();
  chatSection.classList.add("active");
});

btnSearch.addEventListener("click", () => {
  hideAllSections();
  searchSection.classList.add("active");
});

btnNewMemory.addEventListener("click", () => {
  hideAllSections();
  newMemorySection.classList.add("active");
});

window.onload = () => {
  hideAllSections();
  memoriesSection.classList.add("active");
  renderMemories();
};

// Ø¹Ø±Ø¶ Ø§Ù„Ø°ÙƒØ±ÙŠØ§Øª
function renderMemories() {
  const container = document.getElementById("memoriesList");
  container.innerHTML = "";
  if (memories.length === 0) {
    container.innerHTML = "<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø°ÙƒØ±ÙŠØ§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.</p>";
    return;
  }
  memories.forEach((memory) => {
    const div = document.createElement("div");
    div.className = "memory";
    div.dataset.id = memory.id;
    div.innerHTML = `
      <h3>${memory.title} <small>(${memory.mood})</small></h3>
      <p>${memory.text}</p>
      <div class="memory-buttons">
        <button class="like-btn">ğŸ‘ ${memory.likes}</button>
        <button class="comment-btn">ğŸ’¬ ${memory.commentsCount}</button>
      </div>
      <div class="comments-list">
        ${memory.comments
          .map(
            (c) =>
              `<div class="comment">${c.photoURL ? `<img src="${c.photoURL}" alt="avatar" />` : ""}<strong>${c.displayName}:</strong> ${c.text}</div>`
          )
          .join("")}
      </div>
    `;
    container.appendChild(div);
  });

  // Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨
  document.querySelectorAll(".like-btn").forEach((btn) => {
    btn.onclick = (e) => {
      const memoryDiv = e.target.closest(".memory");
      const id = memoryDiv.dataset.id;
      likeMemory(id);
    };
  });
  // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ ØªÙØªØ­ prompt
  document.querySelectorAll(".comment-btn").forEach((btn) => {
    btn.onclick = (e) => {
      const memoryDiv = e.target.closest(".memory");
      const id = memoryDiv.dataset.id;
      commentMemory(id);
    };
  });
}

function likeMemory(id) {
  const memory = memories.find((m) => m.id === id);
  if (!memory) return;
  memory.likes++;
  renderMemories();
}

function commentMemory(id) {
  const memory = memories.find((m) => m.id === id);
  if (!memory) return;
  const commentText = prompt("Ø£Ø¶Ù ØªØ¹Ù„ÙŠÙ‚Ùƒ:");
  if (commentText && commentText.trim() !== "") {
    memory.comments.push({ displayName: "Ø£Ù†Øª", text: commentText.trim(), photoURL: null });
    memory.commentsCount++;
    renderMemories();
  }
}

// Ø¯Ø±Ø¯Ø´Ø© ÙˆÙ‡Ù…ÙŠØ© Ø¨Ø³ÙŠØ·Ø©
const chatWindow = document.getElementById("chatWindow");
const chatInput = document.getElementById("chatInput");
const sendChatBtn = document.getElementById("sendChatBtn");

function addChatMessage(text, isUser = true) {
  const div = document.createElement("div");
  div.className = "chat-message";
  if (isUser) div.classList.add("user");
  div.textContent = text;
  chatWindow.appendChild(div);
  chatWindow.scrollTop = chatWindow.scrollHeight;
}

sendChatBtn.onclick = () => {
  const msg = chatInput.value.trim();
  if (msg === "") return;
  addChatMessage(msg, true);
  chatInput.value = "";
  setTimeout(() => {
    addChatMessage("Ø±Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠ: " + msg.split("").reverse().join(""), false);
  }, 1000);
};

// Ø¨Ø­Ø« Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆÙ‡Ù…ÙŠ
const searchInput = document.getElementById("searchInput");
const searchResults = document.getElementById("searchResults");

searchInput.addEventListener("input", () => {
  const q = searchInput.value.trim().toLowerCase();
  searchResults.innerHTML = "";
  if (q === "") return;
  const filtered = users.filter((u) => u.displayName.toLowerCase().includes(q));
  if (filtered.length === 0) {
    searchResults.innerHTML = "<li>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†.</li>";
    return;
  }
  filtered.forEach((user) => {
    const li = document.createElement("li");
    li.textContent = user.displayName;
    searchResults.appendChild(li);
  });
});

// Ù†Ø´Ø± Ø°ÙƒØ±Ù‰ Ø¬Ø¯ÙŠØ¯Ø©
const memoryForm = document.getElementById("memoryForm");
const memoryTitle = document.getElementById("memoryTitle");
const memoryText = document.getElementById("memoryText");
const moodSelect = document.getElementById("moodSelect");
const memoryImage = document.getElementById("memoryImage");

memoryForm.addEventListener("submit", (e) => {
  e.preventDefault();
  const title = memoryTitle.value.trim();
  const text = memoryText.value.trim();
  const mood = moodSelect.value;

  if (!title || !text || !mood) {
    alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.");
    return;
  }

  const newMemory = {
    id: "m" + (memories.length + 1),
    title,
    text,
    mood,
    likes: 0,
    commentsCount: 0,
    comments: [],
  };

  // Ø¯Ø¹Ù… ØªØ­Ù…ÙŠÙ„ ØµÙˆØ±Ø© Ø¨Ø´ÙƒÙ„ Ø¨Ø³ÙŠØ· ÙƒÙ€ base64
  if (memoryImage.files.length > 0) {
    const file = memoryImage.files[0];
    const reader = new FileReader();
    reader.onload = function(event) {
      newMemory.imageData = event.target.result; // base64 image
      memories.unshift(newMemory);
      resetMemoryForm();
      renderMemories();
      hideAllSections();
      memoriesSection.classList.add("active");
    };
    reader.readAsDataURL(file);
  } else {
    memories.unshift(newMemory);
    resetMemoryForm();
    renderMemories();
    hideAllSections();
    memoriesSection.classList.add("active");
  }
});

function resetMemoryForm() {
  memoryTitle.value = "";
  memoryText.value = "";
  moodSelect.value = "";
  memoryImage.value = "";
}
</script>

</body>
</html>
